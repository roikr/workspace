package{	import com.smartfoxserver.openspace.engine.model.avatar.Avatar;	import com.smartfoxserver.openspace.shared.view.items.Tile;		import flash.display.*;	// This import is required or Flash CS3 won't be able to compile; no issues with CS4 instead	import flash.text.*;	// This import is required or Flash CS3 won't be able to compile; no issues with CS4 instead		import flash.events.TimerEvent;	import flash.text.TextFieldAutoSize;	import flash.utils.Timer;	import flash.utils.getTimer;		public class ChatpetzGhost extends Avatar	{		private const MESSAGE_DURATION:int = 4000				private var balloonTimer:Timer				public function ChatpetzGhost()		{			super();		}				override public function init():void		{			tf_name.text = this.avatarName						// Hide chat balloon			getChildByName("balloon").visible = false						// Start timer to check balloon messages			balloonTimer = new Timer(1000)			balloonTimer.addEventListener(TimerEvent.TIMER, onBalloonTimer)			balloonTimer.start()		}				override public function onMessage(message:String, isPrivate:Boolean):void		{			var balloon:MovieClip = getChildByName("balloon") as MovieClip			balloon.visible = true			//balloon.tf_msg.autoSize = TextFieldAutoSize.LEFT			balloon.nextTime = getTimer() + MESSAGE_DURATION			balloon.tf_msg.text += message + "\t\n"						updateBalloon()		}				// --------------------------------------------------------------------------- //				private function onBalloonTimer(evt:TimerEvent):void		{			var balloon:MovieClip = getChildByName("balloon") as MovieClip			if (getTimer() > balloon.nextTime)			{				var txt:String = balloon.tf_msg.text				txt = txt.substr(txt.indexOf("\t") + 2, txt.length)				balloon.tf_msg.text = txt				updateBalloon()				balloon.nextTime = getTimer() + MESSAGE_DURATION				if (balloon.tf_msg.text.length == 0)					balloon.visible = false			}		}				private function updateBalloon():void		{			var balloon:MovieClip = getChildByName("balloon") as MovieClip						//balloon.center.height = balloon.tf_msg.textHeight - 5			//balloon.bottom.y = balloon.center.y + balloon.center.height			//balloon.y = - balloon.height - 50		}	}}